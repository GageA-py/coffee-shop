{% extends 'base.html' %}

{% block content %}
<div class="max-w-lg mx-auto bg-white shadow-lg rounded-lg translate-y-5">
    <div class="p-4">
        <h2 class="text-2xl font-bold mb-4">Shopping Cart</h2>
        
        <!-- Cart Item -->
        {% for item in cart_items %}
        <div class="flex items-center justify-between py-3 border-b border-gray-200">
            <div class="flex items-center">
                {% if item.product.image %}
                <img src="{{ url_for('static', filename=item.product.image) }}" alt="{{ item.product.name }}" class="w-32 h-32">
                {% else %}
                <div class="w-full h-32 flex items-center justify-center bg-gray-200">Coming Soon...</div>
                {% endif %}
                <div class="ml-4">
                    <h3 class="text-lg font-semibold">{{ item.product.name }}</h3>
                    <p class="text-sm text-gray-600">x{{ item.quantity }}</p>
                    <p class="text-sm text-orange-900">${{ item.product.price }}</p>
                </div>
            </div>
            <div class="flex items-center">
                <!-- Ensure the form is correctly opened and closed -->
                <form action="{{ url_for('remove_from_cart', product_id=item.product.id) }}" method="POST">
                    {{ checkout_form.hidden_tag() }}
                    <button type="submit" class="px-4 py-2 text-red-600 bg-red-100 rounded hover:bg-red-200">Remove</button>
                </form>
            </div>
        </div>
        {% endfor %}
        
        <div class="mt-4">
            <h3 class="text-xl font-semibold">Total: ${{ total }}</h3>
            
            <form action="{{ url_for('create_checkout_session') }}" method="POST">
                {{ checkout_form.hidden_tag() }}
                {{ checkout_form.submit(class="w-full py-2 mt-4 text-white bg-orange-900 rounded hover:bg-orange-800") }}
            </form>
            
        </div>
    </div>
</div>
{% endblock %}
